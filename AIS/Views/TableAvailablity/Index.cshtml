@using AIS.Extensions;
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LayoutBase.cshtml";
}
@section styles
{
    <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css" />
    <link href="../../css/jquery.onoff.css" rel="stylesheet" type="text/css" />
    <link href="../../css/TableAvailability/TACommon.css" rel="stylesheet" type="text/css" />
    <link href="../../css/jquery.cluetip.css" rel="stylesheet" type="text/css" />
    <style>
        .hasDatepicker {
            margin-bottom: 10px;
        }

        .tblvail-sec {
            height: auto !important;
            width: calc(100% - 160px) !important;
        }

        .tblvail-sec-toggle1 {
            width: 98% !important;
        }

        .tblvail-sec .avail-main-tab {
            width: 100%;
            float: left;
        }

        .tblvail-sec .calendar-top-row {
            width: 100%;
            float: left;
            border-bottom: solid 1px #d6d6d6;
        }

            .tblvail-sec .calendar-top-row ul {
                list-style: none;
                float: right;
            }

                .tblvail-sec .calendar-top-row ul li {
                    width: auto;
                    float: left;
                    color: #a2a2a2;
                    font-weight: 500;
                    font-size: 14px;
                    line-height: normal;
                    text-align: center;
                    font-family: 'Lato', sans-serif;
                }

                    .tblvail-sec .calendar-top-row ul li img {
                        padding: 5px 0;
                    }

                    .tblvail-sec .calendar-top-row ul li a {
                        color: #a2a2a2;
                        text-decoration: none;
                        display: block;
                        padding: 10px 15px;
                        border-left: solid 1px #d6d6d6;
                    }

                        .tblvail-sec .calendar-top-row ul li a:hover {
                            background: #efefef;
                            color: #000;
                        }

                        .tblvail-sec .calendar-top-row ul li a.active {
                            background: #efefef;
                            color: #000;
                        }

            .tblvail-sec .calendar-top-row input.today-btn {
                float: left;
                color: #fff;
                font-weight: 500;
                font-size: 16px;
                line-height: normal;
                background: #e8867c;
                border: none;
                border-radius: 5px;
                -webkit-border-radius: 5px;
                -moz-border-radius: 5px;
                -o-border-radius: 5px;
                padding: 12px 20px;
                margin: 15px 0 0 12px;
                font-family: 'Lato', sans-serif;
                box-shadow: 0 3px 0px #7e4943;
                -webkit-box-shadow: 0 3px 0px #7e4943;
                -moz-box-shadow: 0 3px 0px #7e4943;
                -o-box-shadow: 0 3px 0px #7e4943;
                cursor: pointer;
            }

            .tblvail-sec .calendar-top-row .select-t {
                width: 115px;
                height: 44px;
                float: left;
                border: solid 1px #eaeaea;
                overflow: hidden;
                margin: 15px 0 0 18px;
                border-radius: 5px;
                -webkit-border-radius: 5px;
                -moz-border-radius: 5px;
                -o-border-radius: 5px;
                box-shadow: 0 3px 0px #cfcfcf;
                -webkit-box-shadow: 0 3px 0px #cfcfcf;
                -moz-box-shadow: 0 3px 0px #cfcfcf;
                -o-box-shadow: 0 3px 0px #cfcfcf;
                background: url("/images/select-arrow.png") no-repeat scroll 88% 50% rgba(0, 0, 0, 0);
            }

                .tblvail-sec .calendar-top-row .select-t select {
                    color: #626262;
                    width: 125%;
                    height: 44px;
                    font-weight: 500;
                    font-size: 16px;
                    float: left;
                    padding: 9px 0 5px 7px;
                    font-family: 'Lato', sans-serif;
                    background: none;
                    border: none;
                    box-shadow: 0 2px 2px #e8e8e8;
                    -webkit-box-shadow: 0 2px 2px #e8e8e8;
                    -moz-box-shadow: 0 2px 2px #e8e8e8;
                    -o-box-shadow: 0 2px 2px #e8e8e8;
                    box-sizing: border-box;
                    -webkit-box-sizing: border-box;
                    -moz-box-sizing: border-box;
                }

            .tblvail-sec .calendar-top-row .date-picker {
                width: 275px;
                float: left;
                margin: 15px 0 0 12px;
                position: relative;
            }

                .tblvail-sec .calendar-top-row .date-picker input[type="text"] {
                    width: 100%;
                    float: left;
                    border: solid 1px #eaeaea;
                    overflow: hidden;
                    border-radius: 5px;
                    padding: 12px 0;
                    color: #626262;
                    font-weight: 500;
                    font-size: 16px;
                    font-family: 'Lato', sans-serif;
                    text-align: center;
                    border-radius: 5px;
                    -webkit-border-radius: 5px;
                    -moz-border-radius: 5px;
                    -o-border-radius: 5px;
                    box-shadow: 0 3px 0px #cfcfcf;
                    -webkit-box-shadow: 0 3px 0px #cfcfcf;
                    -moz-box-shadow: 0 3px 0px #cfcfcf;
                    -o-box-shadow: 0 3px 0px #cfcfcf;
                    box-sizing: border-box;
                    -webkit-box-sizing: border-box;
                    -moz-box-sizing: border-box;
                }

        .tblvail-sec .for-edit-section {
            width: 100%;
            float: left;
            background: #f8f8f8;
            border-bottom: solid 1px #d6d6d6;
        }

        .tblvail-sec .avail-main-tab table.avail-table {
            width: 91.7%;
            float: left;
            border-left: 1px solid #D6D6D6;
            border-right: 1px solid #D6D6D6;
        }

            .tblvail-sec .avail-main-tab table.avail-table thead {
                float: left;
                border-bottom: 1px solid #D6D6D6;
                background: #fcfcfc; /* Old browsers */
                background: -moz-linear-gradient(top, #fcfcfc 73%, #f4f4f4 0%); /* FF3.6+ */
                background: -webkit-gradient(linear, left top, left bottom, color-stop(73%,#fcfcfc), color-stop(0%,#f4f4f4)); /* Chrome,Safari4+ */
                background: -webkit-linear-gradient(top, #fcfcfc 73%,#f4f4f4 0%); /* Chrome10+,Safari5.1+ */
                background: -o-linear-gradient(top, #fcfcfc 73%,#f4f4f4 0%); /* Opera 11.10+ */
                background: -ms-linear-gradient(top, #fcfcfc 73%,#f4f4f4 0%); /* IE10+ */
                background: linear-gradient(to bottom, #fcfcfc 73%,#f4f4f4 0%); /* W3C */
                filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#fcfcfc', endColorstr='#f4f4f4',GradientType=0 ); /* IE6-9 */ /*linear-gradient(to bottom, #FCFCFC 73%, #F4F4F4 0%) repeat scroll 0 0 rgba(0, 0, 0, 0);*/
            }

                .tblvail-sec .avail-main-tab table.avail-table thead tr {
                    float: left;
                }

                    .tblvail-sec .avail-main-tab table.avail-table thead tr td {
                        color: #858585;
                        font-size: 13px;
                        font-weight: 500;
                        font-family: arial;
                        text-align: left;
                        width: 32px;
                        height: 29px;
                        padding: 10px 0 7px 10px;
                        border-bottom: 1px solid #EEEEEE;
                        box-sizing: border-box;
                        -webkit-box-sizing: border-box;
                        -moz-box-sizing: border-box;
                    }

                        .tblvail-sec .avail-main-tab table.avail-table thead tr td:last-child {
                            border-right: 1px solid #EEEEEE;
                        }

            .tblvail-sec .avail-main-tab table.avail-table tr td.tblnm:last-child {
                padding: 0;
                width: 70px;
                text-align: center;
            }

            .tblvail-sec .avail-main-tab table.avail-table tbody {
                float: left;
            }

                .tblvail-sec .avail-main-tab table.avail-table tbody tr {
                    float: left;
                }

                    .tblvail-sec .avail-main-tab table.avail-table tbody tr td {
                        border-bottom: 1px solid #D6D6D6;
                        border-left: 1px solid #D6D6D6;
                        box-sizing: border-box;
                        color: #000000;
                        font-family: arial;
                        font-size: 13px;
                        font-weight: bold;
                        height: 32px;
                        text-align: center;
                        width: 32px;
                        margin: 0px;
                        padding: 0px;
                    }

                        /* table status colors */
                        .tblvail-sec .avail-main-tab table.avail-table tbody tr td.tblSts0 {
                            background: #FFFFFF;
                        }

                        .tblvail-sec .avail-main-tab table.avail-table tbody tr td > a {
                            padding: 8px 10px;
                        }

                            .tblvail-sec .avail-main-tab table.avail-table tbody tr td > a span {
                                padding: 0 4px;
                            }

                        .tblvail-sec .avail-main-tab table.avail-table tbody tr td.tblSts1 {
                            background: #74DF00;
                        }

                        .tblvail-sec .avail-main-tab table.avail-table tbody tr td.tblSts2 {
                            background: #D8D8D8;
                        }

                        .tblvail-sec .avail-main-tab table.avail-table tbody tr td.tblSts3 {
                            background: #81BEF7;
                        }

                        .tblvail-sec .avail-main-tab table.avail-table tbody tr td.tblSts4 {
                            background: #FF8080;
                            position: relative;
                        }

                        .tblvail-sec .avail-main-tab table.avail-table tbody tr td.bhr {
                            border-left: 1px solid #000000;
                        }

            /* shift status colors */
            .tblvail-sec .avail-main-tab table.avail-table thead tr td.shft0 {
                padding: 10px 0 6px 0px;
                border-bottom: 4px solid transparent;
            }

            .tblvail-sec .avail-main-tab table.avail-table thead tr td.shft1 {
                padding: 10px 0 6px 0px;
                border-bottom: 4px solid #A9D0F5;
            }

            .tblvail-sec .avail-main-tab table.avail-table thead tr td.shft2 {
                padding: 10px 0 6px 0px;
                border-bottom: 4px solid #F7BE81;
            }

            .tblvail-sec .avail-main-tab table.avail-table thead tr td.shft3 {
                padding: 10px 0 6px 0px;
                border-bottom: 4px solid #F5A9A9;
            }

            .tblvail-sec .avail-main-tab table.avail-table thead tr td.shft4 {
                padding: 10px 0 6px 0px;
                border-bottom: 4px solid #F2F5A9;
            }

            .tblvail-sec .avail-main-tab table.avail-table thead tr td span {
                left: -7px;
                position: relative;
            }

                .tblvail-sec .avail-main-tab table.avail-table thead tr td span.arw {
                    background: url("/images/1403094036_icon-arrow-down-b.png") no-repeat scroll 0px 13px rgba(0, 0, 0, 0);
                    color: #000000;
                    font-weight: bold;
                    padding: 0 4px 10px;
                }

        /**/
        .btmDiv {
            float: left;
            width: 100%;
            height: 36px;
            padding: 10px 0;
            border: 1px solid #bcbcbc;
            background: #ffffff;
            border-radius: 4px;
            -webkit-border-radius: 4px;
            font-size: 14px;
            font-family: 'Lato', sans-serif;
        }

            .btmDiv img {
                margin-right: 5px;
                float: left;
            }

            .btmDiv span {
                float: left;
            }

            .btmDiv .reser {
                float: left;
                width: 97px;
                height: auto;
                color: #ea4040;
            }

            .btmDiv .free {
                float: left;
                width: 63px;
                height: auto;
                padding-left: 9px;
                color: #67d50e;
            }

            .btmDiv .n-avai {
                float: left;
                width: 114px;
                height: auto;
                padding-left: 9px;
                color: #bcbcbc;
            }

            .btmDiv .section {
                float: left;
                width: 293px;
                height: auto;
                -moz-box-sizing: border-box;
            }

                .btmDiv .section strong {
                    float: left;
                    width: auto;
                    margin-left: 19px;
                    color: #434a54;
                    font-size: 14px;
                }

            .btmDiv .secSelect {
                float: left;
                width: 293px;
                height: auto;
                padding: 0 0 0 0;
                margin: 5px 0 0 5px;
                font-size: 14px;
                color: #000;
                text-align: left;
            }

            .btmDiv input[type="button"] {
                background: none repeat scroll 0 0 rgba(0, 0, 0, 0);
                border: 1px solid #EEEEEE;
                border-radius: 5px;
                color: #000000;
                cursor: pointer;
                font-family: 'Lato',sans-serif;
                font-size: 11px;
                font-weight: 500;
                margin: 3px 0 0;
                padding: 2px 3px;
            }

        td.tblSts4 .frnt-right-popup {
            right: 147%;
            top: -353px;
        }

        td.tblSts4 div:hover .frnt-right-popup {
            display: block;
        }

        .mCSB_scrollTools_horizontal {
            bottom: -4px !important;
            position: fixed;
        }

        .ta-search-main {
            float: right;
            margin: 10px 0 0;
            width: 110px;
        }

            .ta-search-main p {
                float: left;
                line-height: 45px;
                width: 34px;
            }

            .ta-search-main .onoffswitch {
                width: 60px;
            }

            .ta-search-main .onoffswitch-inner:before, .ta-search-main .onoffswitch-inner:after {
                /* background: none repeat scroll 0 0 #E8867C; */
                color: #FFFFFF;
            }

            .ta-search-main .onoffswitch-switch {
                right: 30px;
            }

        /****Popup CSS****/

        .frnt-right-popup {
            height: auto;
            position: relative;
        }

        .pop-sec-btn input[type="button"] {
            float: none;
            margin-right: inherit;
        }

        .pop-sec-btn input[type="button"] {
            background: none repeat scroll 0 0 #FFFFFF;
            border: 1px solid #D0D4D9;
            border-radius: 4px;
            box-shadow: 0 2px 0 #D1D1D1;
            color: #434A54;
            cursor: pointer;
            font-family: 'Lato',sans-serif;
            font-size: 16px;
            padding: 10px 25px;
        }

        .ui-widget-content {
            border: none !important;
        }

        .ui-widget-header {
            background: none !important;
            border: none !important;
        }

        .cluetip-jtip .cluetip-inner {
            padding: 5px !important;
        }

        .select-wrapper .holder {
            margin: 0 30px 0 5px !important;
        }

        /* Notes edit css starts here */

        input.pop-sec-note-btn-save[type="button"] {
            background: url("../images/icon-pop-save.png") no-repeat scroll center 50% #FFFFFF !important;
            border: 1px solid #D0D4D9 !important;
            border-radius: 4px !important;
            box-shadow: 0 2px 0 #D1D1D1 !important;
            color: rgba(0, 0, 0, 0) !important;
            cursor: pointer !important;
            font-family: 'Lato',sans-serif !important;
            font-size: 0 !important;
            height: 32px !important;
            width: 32px !important;
        }

        input.pop-sec-note-btn-cancel[type="button"] {
            background: url("../images/icon-pop-delete.png") no-repeat scroll center 50% #FFFFFF !important;
            border: 1px solid #D0D4D9 !important;
            border-radius: 4px !important;
            box-shadow: 0 2px 0 #D1D1D1 !important;
            color: rgba(0, 0, 0, 0) !important;
            cursor: pointer !important;
            font-family: 'Lato',sans-serif !important;
            font-size: 0 !important;
            height: 32px !important;
            margin-left: 12px !important;
            width: 32px !important;
        }

        input.pop-sec-note-btn-save[type="button"]:hover {
            background: url("../images/icon-pop-save-hover.png") no-repeat scroll center 50% #E8867C !important;
            border: 1px solid #E8867C !important;
            box-shadow: 0 2px 0 #E1675B !important;
            color: #FFFFFF !important;
        }

        input.pop-sec-note-btn-cancel[type="button"]:hover {
            background: url("../images/icon-pop-delete-hover.png") no-repeat scroll center 50% #E8867C !important;
            border: 1px solid #E8867C !important;
            box-shadow: 0 2px 0 #E1675B !important;
            color: #FFFFFF !important;
        }

        /* Notes edit css ends here */

        /********/
    </style>
}
@section scripts
{
    <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js" type="text/javascript"></script>
    <script src="../../js/jquery.screwdefaultbuttonsV2.js" type="text/javascript"></script>
    <script src="../../js/lemmon-slider.js" type="text/javascript"></script>
    <script src="../../js/jquery.hoverIntent.js" type="text/javascript"></script>
    <script src="../../js/jquery.cluetip.js" type="text/javascript"></script>
    <script src="../../Scripts/TableAvailability/TACommon.js" type="text/javascript"></script>
    <script src="../../Scripts/Floor/Reservations.js" type="text/javascript"></script>
    <script type="text/javascript">
        var hidePopUpOnClick = false;

        $(function () {
            $('body').css('overflow-x', 'hidden');

            $('.m-left-btn').off('click').click(function () {
                $('.menu-bar').toggleClass('menu-bar-toggle');
                $('.m-left-btn').toggleClass('m-left-btn-toggle');
                $('.middle-section').toggleClass('middle-section-toggle1');
                $('.hours-section').toggleClass('hours-section-toggle1');
            });

            $("#datepicker").datepicker({
                format: 'd/m/yy'
            }).datepicker('setDate', '0');

            $('#datepicker').change();
        });

        $('#datepicker').change(function () {
            UpdateFilter();
            getTableAvailability(filterForm);
        });

        function setDateFun(type) {
            var actualDate = $("#datepicker").datepicker('getDate');
            var newDate = null

            if (type == 'p') {
                newDate = new Date(actualDate.getFullYear(), actualDate.getMonth(), actualDate.getDate() - 1);
            } else {
                newDate = new Date(actualDate.getFullYear(), actualDate.getMonth(), actualDate.getDate() + 1);
            }

            $("#datepicker").datepicker({
                format: 'd/m/yy'
            }).datepicker('setDate', newDate);

            $("#datepicker").change();
        }
        function setTodayDate() {
            var actualDate = new Date();
            newDate = new Date(actualDate.getFullYear(), actualDate.getMonth(), actualDate.getDate());

            $("#datepicker").datepicker({
                format: 'd/m/yy'
            }).datepicker('setDate', newDate);

            $("#datepicker").change();
        }
        function getTableAvailability(filters) {
            $("#tabody").load('/TableAvailablity/getTableAvailablityNew', filters + '&date=' + $("#datepicker").val() + '&shiftId=' + $("#shift").val(), function () {

                $(".demo-x").mCustomScrollbar({
                    axis: "x",
                    advanced: { autoExpandHorizontalScroll: true }
                });

                AssignSectionSlider();

                $('.frnt-right-popup').show();

                $('a.jt').cluetip({
                    cluetipClass: 'jtip',
                    arrows: true,
                    dropShadow: false,
                    width: 347,
                    sticky: true,
                    mouseOutClose: false,
                    local: true,
                    multiple: false,
                    cursor: 'pointer',
                    ajaxCache: false,
                    attribute: 'rel',
                    closePosition: 'title',
                    closeText: '<img src="/images/btn-close.png" alt="close" />'
                    //                    onActivate: function (event) {
                    //                        if (hidePopUpOnClick) {
                    //                            return false;
                    //                        }
                    //                    },
                    //                    onHide: function () {
                    //                        hidePopUpOnClick = false;
                    //                    }
                });

                DesignCustomDropdowns();

                $(".addDet").click(function () {
                    $(this).toggleClass("addexp");
                    $(".addCont").toggleClass("show", 200);
                });
            });
        }

        function DesignCustomDropdowns() {
            $(".custom-select").each(function () {
                if ($(this).parents('.select-wrapper').length == 0) {
                    $(this).wrap("<span class='select-wrapper'></span>");
                    $(this).after("<span class='holder'></span>");
                    var selectedOption = $(this).find(":selected").text();
                    $(this).next(".holder").text(selectedOption);
                }
            });
            $(".custom-select").change(function () {
                var selectedOption = $(this).find(":selected").text();
                $(this).next(".holder").text(selectedOption);
            });
        }
    </script>
    <script type="text/javascript">
        window.onload = function () {

            // slider 1
            AssignSectionSlider();
        }

        function AssignSectionSlider() {
            $('#topslider1').lemmonSlider('destroy').lemmonSlider({
                infinite: false
            });
        }
    </script>
    <script type="text/javascript">

        var filterForm = null;

        $(function () {
            $("#onoffswitch1").click(function () {
                if ($("#onoffswitch1").is(":checked")) {
                    $('#tblAvailFilter').show();
                    $('#tblAvailTable').hide();
                } else {
                    $('#tblAvailTable').show();
                    $('#tblAvailFilter').hide();
                    UpdateFilter();
                    getTableAvailability(filterForm);
                }
            });

            UpdateFilter();
        })

        function UpdateFilter() {
            //debugger;
            filterForm = $('#filterForm').serialize();
        }

        function UpadateReservationSuccess(data, resId) {
            if (data.Status == 'Success') {
                DesignCustomDropdowns();
                alert('Reservation updated successfully...');
                UpdateFilter();
                getTableAvailability(filterForm);
                $(document).trigger('hideCluetip');
            }
            else {
                alert(data.Message);
            }
        }

        function DeleteReservationSuccess(data, resId) {
            if (data.Status == 'Success') {
                alert('Reservation deleted successfully...');
                UpdateFilter();
                getTableAvailability(filterForm);
            }
            else {
                alert(data.Message);
            }
        }
    </script>
}
<div class="middle-section tblvail-sec">
    <div class="top-filter">
        <ul style="width: auto;">
            <li><a href="/Setting/Index">Settings</a></li>
            <li><a href="/User/Index">Users</a></li>
            <li><a href="/ShiftHour/Index">Hours</a></li>
            <li><a href="/Floor/Index">Floorplan</a></li>
            <li><a class="active" href="/TableAvailablity/Index">Table Availability</a></li>
            
        </ul>
        <div class="ta-search-main">
            <p>
                Filter
            </p>
            <div class="onoffswitch">
                <input id="onoffswitch1" class="onoffswitch-checkbox" type="checkbox" />
                <label class="onoffswitch-label" for="onoffswitch1">
                    <div style="" class="onoffswitch-inner">
                    </div>
                    <div style="" class="onoffswitch-switch">
                    </div>
                </label>
            </div>
        </div>
    </div>
    <div id="tblAvailTable">
        <div class="calendar-top-row">
            <div style="float: left; padding: 19px;">
                <h1>
                    Table Availability
                </h1>
            </div>
            <div style="float: right">
                <input type="button" name="" value="Today" class="today-btn" onclick="setTodayDate()" />
                <div class="date-picker">
                    <div class="cleft" style="width: 100px;" onclick="setDateFun('p')">
                    </div>
                    <input type="text" id="datepicker" />
                    <div class="cright" style="width: 100px;" onclick="setDateFun('n')">
                    </div>
                </div>
                <div class="select-t">
                    @Html.DropDownList("shift", (SelectList)ViewBag.shiftDDl, "All Shift", new { onChange = "{UpdateFilter();getTableAvailability(filterForm);}" })
                </div>
            </div>
        </div>
        <div class="avail-main-tab" id="tabody">
        </div>
    </div>
    <div id="tblAvailFilter" style="display: none;">
        @Html.Action(
            "GetfilterPartial",
            "TableAvailablity",
            new
            {
                StartDate = DateTime.UtcNow.ToClientTime().ToString("MM/dd/yyyy"),
                EndDate = DateTime.UtcNow.ToClientTime().ToString("MM/dd/yyyy")
            })
    </div>
</div>
